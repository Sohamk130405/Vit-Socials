<% layout('/layouts/boilerplate') -%>
<head>
    <link rel="stylesheet" href="/CSS/chat.css">
</head>
</body>
</html>
<div class="row clearfix">
    <div class="col-lg-12">
        <div class="card chat-app">
            <div id="plist" class="people-list">
                <h4>Select Recipient</h4>
                <ul class="list-unstyled chat-list mt-2 mb-0">
                    <% faculties.forEach(faculty => {%>
                        <li class="clearfix" onclick="location.href='/chats/<%= faculty._id %>'">
                        <div class="about">
                            <div class="name">
                                    <b><i class="fa-solid fa-user"></i></b>       
                                    <%= faculty.name %>
                            </div>                                            
                        </div>
                    </li>
                    <%}); %>
                </ul>
            </div>
            <% if( currUser && receiver ) {%>
                <div class="chat">
                    <div class="chat-header clearfix">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="chat-about ">
                                    <b><i class="fa-solid fa-user"></i></b>
                                    <span class="m-b-0"><b><%= receiver.name %></b></span><br><span class="m-b-0"><b><%= receiver.branch %></b></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-history">
                        <ul class="m-b-0">
                            <% msg1.forEach(m=>{ %>
                                <li class="clearfix">
                                <div class="message my-message"><%= m.msg %></div>
                            </li>
                            <% }) %> 
                            <% msg2.forEach(m=>{ %>
                                <li class="clearfix">
                                <div class="message other-message float-right"><%= m.msg %></div>
                            </li>
                            <% }) %>                              
                        </ul>
                    </div>
                    <div class="chat-message clearfix">
                        <form action="/chats/<%= currUser._id %>/<%= receiver._id %>" method="post">
                            <div class="input-group mb-0">
                                <div class="input-group-prepend mr-2">
                                    <button class="btn btn-info" type="submit">Send</button>
                                </div>
                                <input type="text" class="form-control" placeholder="Enter message here..." name="msg">                                    
                            </div>
                        </form>
                    </div>
                </div>
            <% } %>
        </div>
    </div>
</div>